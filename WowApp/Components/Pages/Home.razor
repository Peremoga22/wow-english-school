@page "/"
@using Microsoft.EntityFrameworkCore
@using WowApp.Resources
@inject ApplicationDbContext Db
@inject ImageService ImageStore

<PageTitle>Домашня</PageTitle>
<div class="ec-hero">
    <div class="container py-0 py-lg-0">

        <!-- TOP: Logo + title -->
        <div class="row align-items-center g-4">
            <div class="col-lg-7">
                
                <div class="brand-block d-flex align-items-center gap-3">
                    <div class="logo-3-wrap">
                        <img src="images/logo2.jpg" alt="English Club Logo" class="logo-3-img">
                    </div>

                    <div class="brand-text">
                        <h1 class="ec-title mb-1">ENGLISH CLUB</h1>
                        <div class="ec-subtitle">we open the world</div>
                    </div>
                </div>


               @*  English for children and adults - *@
                <p class="ec-lead mt-3 mb-0">
                    @SharedResource.Hero_Lead_1
                </p>               
                <div class="ec-video mt-4">
                    <div class="ec-video-wrap">
                        <video class="ec-video-el"
                               src="videos/intro.mp4"
                               autoplay
                               muted
                               loop
                               playsinline
                               controls>
                        </video>                                             
                    </div>
                </div>              
            </div>           

            <div class="col-lg-5">
                <div class="ec-card p-3 p-md-4">
                    <div class="ec-card-title">@SharedResource.QuickSignUpHome</div>
                    <div class="ec-card-text">
                        @SharedResource.TextHome_1
                    </div>
                    <div class="ec-card-text">
                        @SharedResource.TextHome_2
                    </div>


                   @*  <div class="d-grid gap-2 mt-3">
                        <a class="btn btn-primary ec-btn" href="tel:+380982506416">📞 Подзвонити</a>
                        <a class="btn btn-outline-primary ec-btn" href="/contacts">✉️ Контакти</a>
                    </div> *@

                    <div class="ec-mini mt-3">
                        ⏱️ @SharedResource.TextHome_3
                    </div>
                </div>
            </div>
        </div>
        @foreach (var item in rows)        
        {
        <div class="row mt-4 mt-lg-5">
            <div class="col-lg-10 mx-auto">

                <!-- PHOTOS -->
                <div class="ec-photo-middle mb-3">
                         <img src="@item.ImgLeftPath"
                         class="ec-photo ec-photo-side"
                         alt="@item.PhotoTitle">

                         <img src="@item.ImgCenterPath"
                         class="ec-photo ec-photo-center"
                         alt="@item.PhotoTitle">

                         <img src="@item.ImgRightPath"
                         class="ec-photo ec-photo-side"
                        alt="@item.PhotoTitle">
                </div>

                <!-- DESCRIPTION -->
                <div class="ec-photo-desc text-center">
                            <h3 class="ec-photo-title">@item.PhotoTitle</h3>
                    <p class="ec-photo-text">
                                @item.PhotoText
                    </p>
                </div>

           
                @if (!string.IsNullOrWhiteSpace(item.ChristmasTitle) || !string.IsNullOrWhiteSpace(item.ChristmasText))
                {
                    <div class="row mt-4 mt-lg-5">
                        <div class="col-lg-10 mx-auto">
                            <div class="ec-christmas text-center">

                                <div class="ec-christmas-icon">🎄</div>
                                @if (!string.IsNullOrWhiteSpace(item.ChristmasTitle))
                                {
                                    <h3 class="ec-christmas-title">
                                                @item.ChristmasTitle
                                    </h3>
                                }
                                @if (!string.IsNullOrWhiteSpace(item.ChristmasText))
                                {
                                    <p class="ec-christmas-text">
                                                @item.ChristmasText
                                    </p>
                                }

                            </div>
                        </div>
                    </div>
                  }

             </div>
         </div>
         }


        <!-- Middle: 2 columns like flyer -->
        <div class="row g-4 mt-4 mt-lg-5">
            <div class="col-lg-6">
                <div class="ec-block">
                    <div class="ec-block-header">
                        <span class="ec-block-title">@SharedResource.TextHome_4!</span>
                    </div>

                    <ul class="ec-list mb-0">
                        <li><b>@SharedResource.TextHome_5</b> <span class="ec-muted">@SharedResource.TextHome_6</span></li>
                        <li><b>@SharedResource.TextHome_7</b> <span class="ec-muted">@SharedResource.TextHome_8</span></li>
                        <li><b>@SharedResource.TextHome_9</b> <span class="ec-muted">@SharedResource.TextHome_10</span></li>
                        <li><b>@SharedResource.TextHome_11</b> <span class="ec-muted">@SharedResource.TextHome_12</span></li>
                    </ul>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="ec-block">
                    <div class="ec-block-header ec-block-header-alt">
                        <span class="ec-block-title">@SharedResource.TextHome_13!</span>
                    </div>

                    <ul class="ec-list mb-0">
                        <li><b>@SharedResource.TextHome_14</b> <span class="ec-muted">@SharedResource.TextHome_15</span></li>
                        <li><b>@SharedResource.TextHome_16</b> <span class="ec-muted">@SharedResource.TextHome_17</span></li>
                        <li><b>@SharedResource.TextHome_18</b> <span class="ec-muted">@SharedResource.TextHome_19</span></li>
                        <li><b>@SharedResource.TextHome_20</b> <span class="ec-muted">@SharedResource.TextHome_21</span></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- CTA bar -->
        <div class="ec-cta mt-4 mt-lg-5">
            <div class="ec-cta-text">@SharedResource.TextHome_22!</div>
        </div>

        <!-- Chips section like flyer -->
        <div class="row mt-4 mt-lg-5">
            <div class="col-lg-10 mx-auto">
                <div class="ec-chips">
                    <span class="ec-chip">@SharedResource.TextHome_23</span>
                    <span class="ec-chip">@SharedResource.TextHome_24</span>
                    <span class="ec-chip">@SharedResource.TextHome_25</span>
                    <span class="ec-chip">@SharedResource.TextHome_26</span>
                    <span class="ec-chip">@SharedResource.TextHome_27</span>
                    <span class="ec-chip">@SharedResource.TextHome_28</span>
                </div>
            </div>
        </div>

        <!-- Bottom: contacts like flyer -->
        <div class="row g-4 mt-4 mt-lg-5">
            <div class="col-lg-6">
                <div class="ec-footerbox">
                    <div class="ec-footer-title">@SharedResource.TextHome_29</div>
                    <div class="ec-footer-text">
                        <div><b>@SharedResource.TextHome_30:</b> 9:00–21:00</div>
                        <div><b>@SharedResource.TextHome_31:</b> 9:00–15:00</div>
                        <div><b>@SharedResource.TextHome_32:</b> @SharedResource.TextHome_33</div>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="ec-footerbox">
                    <div class="ec-footer-title">@SharedResource.TextHome_34</div>
                    <div class="ec-footer-text">
                        <div><b>@SharedResource.TextHome_35:</b> <a class="ec-link" href="tel:+380982506416">098-250-64-16</a></div>
                        <div><b>Telegram:</b> <span class="ec-muted">@@your_username</span></div>
                        <div><b>E-mail:</b> <a class="ec-link" href="mailto:Lyubovvynnytska87gnail.com">Lyubovvynnytska87@gmail.com</a></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
   
    <!-- Floating actions -->
    <div class="floating-actions">

        <!-- Запис на урок -->
        <a href="/appointment-user" class="btn ec-btn-primary px-4 py-2">
            <span class="icon"></span>
            <span>@SharedResource.TextHome_36</span>
        </a>

        <!-- Зворотній дзвінок -->
        <a href="/callback" class="ec-btn-glass-white px-4 py-2">
            <span class="icon">📞</span>
            <span>@SharedResource.TextHome_37</span>
        </a>

    </div>

</div>


@code {
    [CascadingParameter] public MainLayout? Layout { get; set; }

    private List<HomeSection> rows = new();

    private bool IsEn =>
        CultureInfo.CurrentUICulture.Name.StartsWith("en", StringComparison.OrdinalIgnoreCase);

    protected override async Task OnInitializedAsync()
    {        
        rows = await Db.HomeSections
            .AsNoTracking()
            .Where(x => x.IsCulture == IsEn)   
            .OrderByDescending(x => x.UpdatedAtUtc)
            .ToListAsync();
                  
        if (rows.Count == 0 && IsEn)
        {
            rows = await Db.HomeSections
                .AsNoTracking()
                .Where(x => x.IsCulture == false)
                .OrderByDescending(x => x.UpdatedAtUtc)
                .ToListAsync();
        }
    }

    protected override void OnAfterRender(bool firstRender)
    {
        if (!firstRender) return;

        Layout?.SetSeo(
            "Послуги — English Club WOW | Стрий та онлайн",
            "Групові та індивідуальні заняття з англійської для дітей і дорослих. Speaking Club, підготовка до іспитів, онлайн/офлайн навчання."
        );
    }
}